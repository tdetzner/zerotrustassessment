# B2B Guest Access is enabled for Private Apps in Global Secure Access

## Spec Status

Draft

## Documentation Status

Not started

## Dev Status

Not started

## Minimum License

AAD_PREMIUM_P1, Entra_Premium_Private_Access

## Pillar

Network

## SFI Pillar

Protect networks

## Category

Zero Trust Network Access (ZTNA), B2B Collaboration

## Risk Level

High

## User Impact

Low

## Implementation Cost

Medium

## Customer Facing Explanation

B2B Guest Access for Private Apps in Global Secure Access enables organizations to securely grant external partners, contractors, and vendors access to internal private applications without requiring traditional VPN solutions or complex network federation. This feature extends Microsoft Entra Private Access capabilities to B2B guest users, allowing them to access designated private applications using their home organization credentials while maintaining Zero Trust security principles.

Without B2B Guest Access enabled for private apps, organizations must rely on less secure alternatives such as creating shadow IT accounts, deploying per-partner VPN infrastructure, or granting overly broad network access to external collaborators. These legacy approaches create significant security risks: attackers who compromise a contractor's credentials can access broad network segments rather than specific applications, lateral movement becomes easier due to lack of application-level segmentation, and visibility into external user activity is limited. Traditional VPN solutions grant network-level access that persists for extended sessions, allowing attackers to enumerate internal resources, establish persistence mechanisms, and exfiltrate data across the VPN tunnel. Additionally, when external collaborations end, organizations struggle to revoke access quickly because it requires coordinating with multiple systems and network configurations rather than a centralized identity-based control.

By enabling B2B Guest Access for private apps through Global Secure Access, organizations implement identity-driven, per-application access controls where external users authenticate using their own corporate credentials and are granted access only to specifically designated private applications. The Global Secure Access client routes only authorized application traffic through the secure tunnel, leaving all other network traffic local to the guest's device. Each access attempt is evaluated against Conditional Access policies, enabling MFA requirements, device compliance checks, and continuous access evaluation. All guest access activity is logged and monitored through Microsoft Entra audit logs, providing full visibility for compliance and threat detection. When a partnership ends or a contractor leaves, administrators can revoke access instantly through the Microsoft Entra admin center, immediately terminating the guest's ability to reach private applications.

Risk Level: High - Without B2B Guest Access for private apps, organizations expose internal resources through legacy VPN infrastructure or create unmanaged external accounts, enabling lateral movement and persistent access by external threat actors.

User Impact: Low - Guest users install the Global Secure Access client and authenticate with their home organization credentials; the experience is transparent once configured, and users maintain their familiar authentication workflows.

Implementation Cost: Medium - Requires configuring Private Access applications for guest access, onboarding B2B guest users in Microsoft Entra ID, deploying the Global Secure Access client to guest devices, and establishing appropriate Conditional Access policies for external users.

## Check Query

The assessment checks whether B2B Guest Access is enabled and configured for Private Apps in Global Secure Access, allowing external guest users to access internal private applications through identity-based Zero Trust Network Access.

### Query 1: Q1: Validate that Private Access applications are configured for B2B guest access

**Endpoint:** `https://graph.microsoft.com/beta/networkAccess/connectivity/branches/{branchId}/forwardingProfiles` and `https://graph.microsoft.com/beta/networkAccess/forwardingProfiles?$filter=profileType eq 'private'`

**Documentation:** [Overview of B2B guest access with Global Secure Access](https://learn.microsoft.com/en-us/entra/global-secure-access/concept-b2b-guest-access)

**Property Check:** Private Access forwarding profile configuration and application assignments that allow guest users

**Pass Criteria:** At least one Private Access application is configured and has settings that explicitly enable or allow B2B guest user access

**Fail Criteria:** No Private Access applications are configured for guest access, or all applications explicitly deny guest user access

**Details:** B2B Guest Access requires that Private Access applications be configured to allow external users. This query validates that the Private Access forwarding profile exists and has application segments configured. The presence of guest user assignments to these applications indicates active B2B collaboration for private app access.

### Query 2: Q2: Validate that B2B guest users are assigned to Private Access applications

**Endpoint:** `https://graph.microsoft.com/beta/identity/conditionalAccess/policies?$filter=conditions/users/includeGuestUsers eq true` and `https://graph.microsoft.com/beta/users?$filter=userType eq 'Guest'`

**Documentation:** [Configure Private Access for B2B guests](https://learn.microsoft.com/en-us/entra/external-id/b2b-quickstart-add-guest-users-portal) and [Conditional Access for B2B collaboration users](https://learn.microsoft.com/en-us/entra/external-id/authentication-conditional-access)

**Property Check:** Presence of guest users with assignments to Private Access applications and relevant Conditional Access policies

**Pass Criteria:** Guest users exist in the tenant and are assigned to at least one Private Access application, with Conditional Access policies configured to govern their access

**Fail Criteria:** No guest users are assigned to Private Access applications, or guest users exist but have no access policies defined for Private Access

**Details:** This query validates that B2B guest users are not only configured in the tenant but also actively assigned to Private Access applications. Conditional Access policies should be present to enforce security controls (MFA, device compliance, location restrictions) for guest access to private apps.

### Query 3: Q3: Validate that Global Secure Access client supports B2B guest access

**Endpoint:** `https://graph.microsoft.com/beta/networkAccess/connectivity/branches` and `https://graph.microsoft.com/beta/networkAccess/logs/traffic?$filter=userPrincipalName eq 'guest@domain.com'`

**Documentation:** [Global Secure Access client for Windows](https://learn.microsoft.com/en-us/entra/global-secure-access/how-to-install-windows-client) and [Monitor B2B guest access](https://learn.microsoft.com/en-us/entra/global-secure-access/how-to-monitor-network-traffic)

**Property Check:** Traffic logs or client connectivity indicators showing guest user activity through Global Secure Access

**Pass Criteria:** Traffic logs show guest users successfully connecting to Private Access applications through the Global Secure Access client, indicating active B2B guest access usage

**Fail Criteria:** No guest user traffic is detected in Global Secure Access logs, or client connectivity logs show guest access failures

**Details:** This query validates that B2B guest access is not only configured but actively used. The presence of guest user traffic in Global Secure Access logs confirms that external users are successfully accessing private applications through the Zero Trust Network Access solution.

## User facing message

Pass: B2B Guest Access is enabled for Private Apps in Global Secure Access, with guest users actively assigned and accessing internal applications through identity-based ZTNA controls.

Fail: B2B Guest Access for Private Apps is not configured or enabled, requiring external collaborators to use less secure access methods like VPNs or shadow IT accounts.

Investigate: B2B Guest Access appears configured but no guest users are actively using Private Access applications, or policies are incomplete.

## Test evaluation logic

1. Execute Query 1 (Q1): Retrieve Private Access forwarding profiles and application configurations
2. If no Private Access profile exists or no applications are configured, test result is **Fail**
3. Execute Query 2 (Q2): Check for guest users in the tenant and their assignments to Private Access applications
4. If guest users exist and are assigned to Private Access applications with appropriate Conditional Access policies, continue to Query 3
5. Execute Query 3 (Q3): Validate active guest user traffic through Global Secure Access
6. If guest users are successfully accessing Private Access applications (traffic logs show activity), test result is **Pass**
7. If configuration exists but no active guest traffic is detected, test result is **Investigate**
8. If guest users are not assigned or no policies exist, test result is **Fail**

## Test output data

The test returns information about B2B Guest Access configuration for Private Apps:
- Private Access application names and configurations
- Number of B2B guest users in the tenant
- Guest user assignments to Private Access applications
- Conditional Access policies targeting guest users for Private Access
- Recent guest user activity in Global Secure Access traffic logs
- Global Secure Access client version and compatibility status
- Creation and last modified dates for guest access configurations

Link to Global Secure Access configuration portal: [Microsoft Entra Admin Center - Global Secure Access](https://entra.microsoft.com/#view/Microsoft_AAD_GlobalSecureAccess/GlobalSecureAccessBlade)

Link to B2B guest management: [Microsoft Entra Admin Center - External Identities](https://entra.microsoft.com/#view/Microsoft_AAD_IAM/CompanyRelationshipsMenuBlade/~/ExternalIdentities)

## Remediation resources

To enable B2B Guest Access for Private Apps in Global Secure Access, follow these steps:

1. **Verify licensing and prerequisites**: Ensure your organization has Microsoft Entra ID P1 or P2 licenses and Microsoft Entra Private Access licenses. Guest users do not require licenses in the resource tenant. See [Global Secure Access licensing overview](https://learn.microsoft.com/en-us/entra/global-secure-access/overview-what-is-global-secure-access#licensing-overview) and [External ID pricing](https://azure.microsoft.com/pricing/details/active-directory/external-identities/).

2. **Enable B2B collaboration in your tenant**: Configure external collaboration settings to allow guest users from partner organizations. Navigate to Microsoft Entra admin center > Identity > External Identities > External collaboration settings. See [Configure external collaboration settings](https://learn.microsoft.com/en-us/entra/external-id/external-collaboration-settings-configure).

3. **Configure Private Access for your internal applications**: Set up Private Access applications and connectors for the internal resources you want to share with B2B guests. See [Configure Private Access](https://learn.microsoft.com/en-us/entra/global-secure-access/how-to-configure-private-access) and [Deploy Private Access connectors](https://learn.microsoft.com/en-us/entra/global-secure-access/how-to-configure-connectors).

4. **Invite B2B guest users**: Add external users as guests in your Microsoft Entra tenant using B2B collaboration. Navigate to Microsoft Entra admin center > Users > All users > New guest user. See [Add B2B collaboration guest users](https://learn.microsoft.com/en-us/entra/external-id/b2b-quickstart-add-guest-users-portal).

5. **Assign guest users to Private Access applications**: Grant guest users access to specific Private Access applications. Navigate to Global Secure Access > Applications > Select application > Users and groups > Add user/group. See [Assign users to applications](https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/assign-user-or-group-access-portal).

6. **Configure Conditional Access policies for guest users**: Create or modify Conditional Access policies to enforce security controls for B2B guest access to Private Apps. Include MFA requirements, device compliance, and location restrictions as appropriate. See [Conditional Access for B2B collaboration users](https://learn.microsoft.com/en-us/entra/external-id/authentication-conditional-access) and [Secure access for external users](https://learn.microsoft.com/en-us/entra/external-id/external-identities-overview#secure-access).

7. **Deploy Global Secure Access client to guest devices**: Instruct guest users to install the Global Secure Access client on their devices. The client supports tenant switching, allowing guests to select the resource tenant and access assigned Private Access applications. See [Install the Global Secure Access client](https://learn.microsoft.com/en-us/entra/global-secure-access/how-to-install-windows-client) and [B2B guest access overview](https://learn.microsoft.com/en-us/entra/global-secure-access/concept-b2b-guest-access).

8. **Test and validate guest access**: Have guest users authenticate and access Private Access applications through the Global Secure Access client. Verify that traffic appears in the Global Secure Access logs and that security policies are enforced. See [Monitor Global Secure Access traffic](https://learn.microsoft.com/en-us/entra/global-secure-access/how-to-monitor-network-traffic).

9. **Monitor and audit guest access activity**: Use Microsoft Entra audit logs and Global Secure Access dashboards to track guest user activity, detect anomalies, and ensure compliance. See [Global Secure Access logs and monitoring](https://learn.microsoft.com/en-us/entra/global-secure-access/concept-global-secure-access-logs-monitoring) and [Monitor B2B collaboration users](https://learn.microsoft.com/en-us/entra/external-id/auditing-and-reporting).

10. **Establish guest access lifecycle management**: Implement processes for regular guest access reviews, automatic expiration of guest accounts, and immediate revocation when partnerships end. See [Access reviews for external users](https://learn.microsoft.com/en-us/entra/id-governance/access-reviews-external-users) and [Manage guest access lifecycle](https://learn.microsoft.com/en-us/entra/external-id/what-is-b2b#easily-manage-guest-user-access).

## API Testing and Validation Notes

### Query 1 Endpoint Validation
- **Endpoint**: `https://graph.microsoft.com/beta/networkAccess/forwardingProfiles?$filter=profileType eq 'private'`
- **Status**: Beta API; feature is in preview as of January 2026
- **Expected Response Structure**: Array of forwarding profile objects with application segments
- **Required Permissions**: NetworkAccess.Read.All or Global Secure Access Administrator role
- **Note**: B2B guest access for Private Apps is a preview feature and API endpoints may evolve

### Query 2 Endpoint Validation
- **Endpoint**: `https://graph.microsoft.com/beta/users?$filter=userType eq 'Guest'`
- **Status**: Stable v1.0 API available; using beta for extended properties
- **Dependencies**: Requires cross-referencing guest users with application assignments
- **Permissions**: User.Read.All and Application.Read.All
- **Complexity**: May require multiple API calls to correlate guest users with Private Access app assignments

### Query 3 Endpoint Validation
- **Endpoint**: `https://graph.microsoft.com/beta/networkAccess/logs/traffic`
- **Status**: Beta API; traffic logs are part of Global Secure Access monitoring
- **Pagination**: Traffic logs are paginated and may require filtering by date range
- **Retention**: Log retention policies apply; recent data (last 30 days) recommended for validation
- **Note**: Guest user traffic logs may require specific log analytics workspace configuration
